# Maintainer: Vesa Kaihlavirta <vegai@iki.fi>
pkgname=factor
pkgver=0.92
pkgrel=1
pkgdesc="A general purpose, dynamically typed, stack-based programming language."
arch=(i686 x86_64)
url="http://factorcode.org"
license=(BSD)
conflicts=(factor-git)
depends=(pango freetype2 mesa libgl)
makedepends=(git gcc)
source=(http://downloads.factorcode.org/releases/$pkgver/factor-src-$pkgver.zip 'f')

build() {
    bootimg="boot.x86.32.image"
    [ $CARCH = x86_64 ] && bootimg="boot.unix-x86.64.image"

    cd $srcdir/factor

    make || return 1
    ./factor -i=$bootimg || return 1

    mkdir -p $pkgdir/opt/factor/bin
    mkdir -p $pkgdir/opt/factor/lib/factor
    mkdir -p $pkgdir/opt/factor/share/factor
    mkdir -p $pkgdir/opt/factor/share/licenses/factor

    cp factor $pkgdir/opt/factor/bin/factor
    cp $startdir/f $pkgdir/usr/bin/f
    chmod 0755 $pkgdir/opt/factor/bin/*

    cp -a misc extra core basis $pkgdir/opt/factor/lib/factor/
    cp factor.image $pkgdir/opt/factor/share/factor/factor.image
    cp $srcdir/factor/license.txt $pkgdir/usr/share/licenses/factor/
}
md5sums=('010783a35afc7dc249539a6a1c122499'
         '57fadc2cfdfd6c58717bdb59846801a1')
