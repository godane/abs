# $Id: PKGBUILD 22926 2010-08-02 09:15:46Z spupykin $
# Maintainer: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Maintainer: Timm Preetz <timm@preetz.us>
# Contributor: Michael 'manveru' Fellinger <m.fellinger@gmail.com>
# Contributor: Dave Pretty <david dot pretty at gmail dot com>

pkgname=anki
pkgver=1.0
pkgrel=1
pkgdesc='Helps you remember facts (like words/phrases in a foreign language) efficiently.'
url='http://ichi2.net/anki/'
license=("GPL")
arch=('any')
options=(force)
depends=('pyqt' 'python-sqlalchemy' 'python-simplejson' 'python-pysqlite' 'beautiful-soup')
makedepends=('setuptools' 'desktop-file-utils')
source=(sqlalchemy0.6-db.patch sqlalchemy0.6-deck.patch http://anki.googlecode.com/files/anki-$pkgver.tgz)
md5sums=('53e80f37077b7c08d5714411b717cce7'
         'b8b2148146b6dbd027238125c7e1271e'
         'd09e5f38cf169eb86d473beaab9e6596')

build() {
#  patch -p1 < sqlalchemy0.6-db.patch
#  patch -p1 < sqlalchemy0.6-deck.patch
  cd $srcdir/$pkgname-$pkgver
  export PYTHONPATH=$srcdir/$pkgname-$pkgver/libanki

  (cd libanki && python setup.py install --root $pkgdir) && \
  python setup.py install --root $pkgdir || return 1

  # .desktop file and icon
  desktop-file-install --dir $pkgdir/usr/share/applications $pkgname.desktop && \
  install -D -m 644 icons/$pkgname.png $pkgdir/usr/share/pixmaps/$pkgname.png
}
